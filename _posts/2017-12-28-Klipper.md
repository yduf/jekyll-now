---
title: Klipper (3dprinter firmware)
published: true
tags: 3dprint firmware
excerpt_separator: ""
---
## Overview
[Fast 3D Printing with Raspberry Pi](https://hackaday.com/2017/12/26/fast-3d-printing-with-raspberry-pi-but-not-how-you-think/#more-285911)

[Klipper features](https://github.com/KevinOConnor/klipper/blob/master/docs/Features.md)

## Octoprint Installation

1. Install octoprint
2. Follow [instructions](https://github.com/KevinOConnor/klipper/blob/master/docs/Installation.md) 

- ssh to pi@octopi
- run commands
{% highlight bash %}
git clone https://github.com/KevinOConnor/klipper
./klipper/scripts/install-octopi.sh
{% endhighlight %}

The above will download Klipper, install some system dependencies, setup Klipper to run at system startup, and start the Klipper host software. It will require an internet connection and it may take a few minutes to complete.

## [Flashing firmware](https://github.com/KevinOConnor/klipper/blob/master/docs/Installation.md#building-and-flashing-the-micro-controller)
compile code 
{% highlight bash %}
cd ~/klipper/
make menuconfig
make
{% endhighlight %}

Finally, for common micro-controllers, the code can be flashed with:
Make sure octoprint is disconnected before.
{% highlight bash %}
sudo service klipper stop
make flash FLASH_DEVICE=/dev/ttyUSB0
sudo service klipper start
{% endhighlight %}

**Make sure to restart board afterward**: power off/on printer


## [Configure Octoprint to use Klipper](https://github.com/KevinOConnor/klipper/blob/master/docs/Installation.md#configuring-octoprint-to-use-klipper)

## [Configuring Klipper](https://github.com/KevinOConnor/klipper/blob/master/docs/Installation.md#configuring-klipper)

The Klipper configuration is stored in a text file on the Raspberry Pi. 

Starting from ramp config.
cp ~/klipper/config/generic-ramps.cfg ~/printer.cfg

The default Klipper startup script also places a log in /tmp/klippy.log which provides more detailed information.

## Klipper plugin
There is a Klipper plugin that provide some ui in octoprint
and default config.

## [**Verify** config](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md)

- [Verify temperature](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md#verify-temperature)

 temperature reading seems ok (room temperature)

- [Verify M112](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md#verify-m112)

 M112 => cause disconnect

- [Verify heaters](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md#verify-heaters)

 extruder Temp control => heat / stabilized / off

- [Verify stepper motor enable pin](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md#verify-stepper-motor-enable-pin)

 enable_pin ok, X/Y/Z free move

- [Verify endstops](https://github.com/KevinOConnor/klipper/blob/master/docs/Config_checks.md#verify-endstops)

Send: QUERY_ENDSTOPS
Recv: x:open y:TRIGGERED z:TRIGGERED

Discoeasy default build has [x- trigger on y axis](https://www.iot-experiments.com/dagoma-discoeasy200/)

As it is quite easy to rectify that => I have chanded it as shown here below.

** From now it is obligatory to remap or use alternative [marlin](https://github.com/IoT-Experiments/Marlin-DiscoEasy200)**

![caption](https://www.iot-experiments.com/content/images/2018/01/IMG_20180114_103116.jpg)

** After Remap **

### Open Issue (dagome config)

M112 - works, but hard to reconnect afterward

