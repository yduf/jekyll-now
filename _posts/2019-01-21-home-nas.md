---
published: true
title: custom NAS
tags: nas synology
---
> After some experience with a small Synology NAS, and experencied the blue led of death (fortunaltely solved), I decided to move to my own hardware supporting ZFS - Raid 5. - yves

## Bios version
- UEFI Version J3455-ITX P**1.60** - no more in donwloadable bios ?
- latest availables is [**1.8**](http://asrock.com/mb/Intel/J3455-ITX/?cat=Download&os=BIOS#BIOS)

## Hardware

- [In Win IW-MS04](https://proclockers.com/reviews/computer-cases/in-win-iw-ms04-mini-server-case-review?nopaging=1)
	- fan was quite noisy, changed to [noctua NF-P12 redux-900](https://www.amazon.fr/gp/product/B07C5KZX85/ref=ppx_yo_dt_b_asin_title_o04_s00?ie=UTF8&psc=1) wich was much quiter.
    
- [ASRock J3455-ITX](https://www.ldlc.com/fiche/PB00217669.html) - Quad-Core Intel Celeron J3455 - Goldmont (2016) [> Nehalem (2008)](https://en.wikipedia.org/wiki/List_of_Intel_CPU_microarchitectures)
	- [spec](https://www.asrock.com/mb/Intel/J3455-ITX/#Specification)

### LAN [Realtek RTL8111GR](https://tuxbyte.com/how-to-get-your-realtek-rtl8111rtl8168-working-updated-guide/) **issue** with default driver when too much load

> To solve this problem you have to use the official Realtek **r8168** driver instead of the **r8169** driver, which is included in the Linux Kernel.

- [Potential data loss and security breach when used with nfs server](https://github.com/mtorromeo/r8168/issues/4)

{% highlight bash %}
$ lsmod | grep r81						# check driver present
# default install gives =>
r8169                  81920  0
{% endhighlight %}

#### Easy fix (reboot to activate)
> ** 8.045.08 - Still crashing on heavy load with this driver **

{% highlight bash %}
$ sudo apt-get install r8168-dkms			# force support of that driver
<reboot>
$ lsmod | grep r8168						# check presence
r8168                 524288  0
  
$sudo ethtool -i enp1s0	# check if ethernet card is using the right driver
driver: r8168
version: 8.045.08-NAPI
firmware-version: 
expansion-rom-version: 
bus-info: 0000:01:00.0
supports-statistics: yes
supports-test: no
supports-eeprom-access: no
supports-register-dump: yes
supports-priv-flags: no
{% endhighlight %}

#### Manual install
> version 8.048.02 available on [https://github.com/mtorromeo/r8168/tree/master/src)
  
=> pb a l'install...


## Software Distrib

see [comparison](https://www.reddit.com/r/DataHoarder/comments/6by93u/want_to_build_a_home_nas_freenas_nas4free_or_omv/)
- [Ansible-nas]({% post_url 2019-04-10-ansible-nas %})
	- [Why I Ditched FreeNAS And Replaced It With Ubuntu Server And Ansible](https://davidstephens.uk/ansible/linux/ubuntu/2017/10/05/why-i-ditched-freenas-replaced-with-ubuntu-ansible/)

- [Xpenology](https://xpenology.org/)
	- [6.x Loaders](https://xpenology.com/forum/topic/13333-tutorialreference-6x-loaders-and-platforms/)
	- [ASRock J3455-ITX](https://xpenology.com/forum/topic/9699-asrock-j3455-itx/)
    - [DSM 6.2](https://xpenology.com/forum/topic/13153-dsm-62-possible-on-asrock-j3455-itx/)

- [Freenas](https://www.freenas.org/)
	- [vs OpenMediaVault](https://www.freenas.org/freenas-vs-openmediavault/)
    
- [OpenMediaVAult]()
	- [My perfect 2018 media server. Openmediavault: NAS](https://medium.com/@yllanos/my-perfect-2018-media-server-openmediavault-nas-storage-multimedia-services-53e74ea33af3)
	- [J3455-ITX problems](https://forum.openmediavault.org/index.php/Thread/16375-ASRock-J3455-ITX-problems/)
    
- [Snapraid](https://www.snapraid.it/compare)
